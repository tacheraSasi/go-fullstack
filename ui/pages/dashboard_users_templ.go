// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"github.com/tacheraSasi/go-api-starter/components/button"
	"github.com/tacheraSasi/go-api-starter/components/card"
	"github.com/tacheraSasi/go-api-starter/components/input"
	"github.com/tacheraSasi/go-api-starter/ui/layouts"
)

type DashboardUsersProps struct {
	AppName string
}

func DashboardUsers(props DashboardUsersProps) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div x-data=\"usersManager()\" x-init=\"init()\" class=\"space-y-4\"><div x-cloak x-show=\"error\" class=\"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive\" x-text=\"error\"></div><div x-cloak x-show=\"message\" class=\"rounded-md border border-primary/30 bg-primary/10 px-3 py-2 text-sm text-primary\" x-text=\"message\"></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Var3 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
				templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
				templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
				if !templ_7745c5c3_IsBuffer {
					defer func() {
						templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
						if templ_7745c5c3_Err == nil {
							templ_7745c5c3_Err = templ_7745c5c3_BufErr
						}
					}()
				}
				ctx = templ.InitializeContext(ctx)
				templ_7745c5c3_Var4 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
					templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
					templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
					if !templ_7745c5c3_IsBuffer {
						defer func() {
							templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
							if templ_7745c5c3_Err == nil {
								templ_7745c5c3_Err = templ_7745c5c3_BufErr
							}
						}()
					}
					ctx = templ.InitializeContext(ctx)
					templ_7745c5c3_Var5 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
						templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
						templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
						if !templ_7745c5c3_IsBuffer {
							defer func() {
								templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
								if templ_7745c5c3_Err == nil {
									templ_7745c5c3_Err = templ_7745c5c3_BufErr
								}
							}()
						}
						ctx = templ.InitializeContext(ctx)
						templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "Users ")
						if templ_7745c5c3_Err != nil {
							return templ_7745c5c3_Err
						}
						return nil
					})
					templ_7745c5c3_Err = card.Title().Render(templ.WithChildren(ctx, templ_7745c5c3_Var5), templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, " ")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Var6 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
						templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
						templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
						if !templ_7745c5c3_IsBuffer {
							defer func() {
								templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
								if templ_7745c5c3_Err == nil {
									templ_7745c5c3_Err = templ_7745c5c3_BufErr
								}
							}()
						}
						ctx = templ.InitializeContext(ctx)
						templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "Edit profile data, activate/deactivate users, assign roles, and delete users. ")
						if templ_7745c5c3_Err != nil {
							return templ_7745c5c3_Err
						}
						return nil
					})
					templ_7745c5c3_Err = card.Description().Render(templ.WithChildren(ctx, templ_7745c5c3_Var6), templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					return nil
				})
				templ_7745c5c3_Err = card.Header().Render(templ.WithChildren(ctx, templ_7745c5c3_Var4), templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, " ")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Var7 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
					templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
					templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
					if !templ_7745c5c3_IsBuffer {
						defer func() {
							templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
							if templ_7745c5c3_Err == nil {
								templ_7745c5c3_Err = templ_7745c5c3_BufErr
							}
						}()
					}
					ctx = templ.InitializeContext(ctx)
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<div class=\"overflow-x-auto\"><table class=\"w-full text-left text-sm\"><thead><tr class=\"border-b text-muted-foreground\"><th class=\"px-2 py-2\">ID</th><th class=\"px-2 py-2\">Name</th><th class=\"px-2 py-2\">Email</th><th class=\"px-2 py-2\">Active</th><th class=\"px-2 py-2\">Roles</th><th class=\"px-2 py-2\">Actions</th></tr></thead> <tbody><template x-for=\"user in users\" :key=\"user.id\"><tr class=\"border-b align-top\"><td class=\"px-2 py-2\" x-text=\"user.id\"></td><td class=\"px-2 py-2\">")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = input.Input(input.Props{Class: "h-8", Attributes: templ.Attributes{"x-model": "user.name"}}).Render(ctx, templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "</td><td class=\"px-2 py-2\">")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = input.Input(input.Props{Class: "h-8", Attributes: templ.Attributes{"x-model": "user.email"}}).Render(ctx, templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "</td><td class=\"px-2 py-2\"><input type=\"checkbox\" class=\"mt-2\" x-model=\"user.is_active\"></td><td class=\"px-2 py-2\"><div class=\"mb-2 flex flex-wrap gap-1\"><template x-for=\"role in (user.roles || [])\" :key=\"role.id\"><span class=\"rounded border px-2 py-0.5 text-xs\" x-text=\"role.name\"></span></template></div><div class=\"flex gap-1\"><select class=\"h-8 rounded-md border bg-background px-2 text-xs\" x-model=\"user.selectedRoleId\"><option value=\"\">Select role</option><template x-for=\"role in roles\" :key=\"role.id\"><option :value=\"role.id\" x-text=\"role.name\"></option></template></select> <button class=\"h-8 rounded-md border px-2 text-xs\" @click=\"addRole(user)\">Add</button> <button class=\"h-8 rounded-md border px-2 text-xs\" @click=\"removeRole(user)\">Remove</button></div></td><td class=\"px-2 py-2\"><div class=\"flex gap-1\"><button class=\"h-8 rounded-md border px-2 text-xs\" @click=\"updateUser(user)\">Save</button> <button class=\"h-8 rounded-md border border-destructive/40 px-2 text-xs text-destructive\" @click=\"deleteUser(user.id)\">Delete</button></div></td></tr></template></tbody></table></div>")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					return nil
				})
				templ_7745c5c3_Err = card.Content().Render(templ.WithChildren(ctx, templ_7745c5c3_Var7), templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				return nil
			})
			templ_7745c5c3_Err = card.Card().Render(templ.WithChildren(ctx, templ_7745c5c3_Var3), templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "</div><script nonce=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var8 string
			templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(templ.GetNonce(ctx))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `ui/pages/dashboard_users.templ`, Line: 83, Col: 37}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "\">\n\t\t\tfunction usersManager() {\n\t\t\t\treturn {\n\t\t\t\t\tusers: [],\n\t\t\t\t\troles: [],\n\t\t\t\t\terror: '',\n\t\t\t\t\tmessage: '',\n\t\t\t\t\ttoken: '',\n\t\t\t\t\tasync init() {\n\t\t\t\t\t\tthis.token = localStorage.getItem('auth_token') || '';\n\t\t\t\t\t\tif (!this.token) return;\n\t\t\t\t\t\tawait this.load();\n\t\t\t\t\t},\n\t\t\t\t\tasync load() {\n\t\t\t\t\t\tthis.error = '';\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst [usersResp, rolesResp] = await Promise.all([\n\t\t\t\t\t\t\t\tfetch('/api/v1/admin/users?limit=100&offset=0&active=false', { headers: { 'Authorization': `Bearer ${this.token}` } }),\n\t\t\t\t\t\t\t\tfetch('/api/v1/admin/roles?limit=100&offset=0&active=false', { headers: { 'Authorization': `Bearer ${this.token}` } }),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\tif (!usersResp.ok || !rolesResp.ok) {\n\t\t\t\t\t\t\t\tthis.error = 'Admin access is required for user management.';\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst usersJson = await usersResp.json();\n\t\t\t\t\t\t\tconst rolesJson = await rolesResp.json();\n\t\t\t\t\t\t\tthis.users = (usersJson.data || []).map((u) => ({ ...u, selectedRoleId: '' }));\n\t\t\t\t\t\t\tthis.roles = rolesJson.data || [];\n\t\t\t\t\t\t} catch (_e) {\n\t\t\t\t\t\t\tthis.error = 'Failed to load users.';\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tasync updateUser(user) {\n\t\t\t\t\t\tthis.message = '';\n\t\t\t\t\t\tthis.error = '';\n\t\t\t\t\t\tconst resp = await fetch(`/api/v1/users/${user.id}`, {\n\t\t\t\t\t\t\tmethod: 'PUT',\n\t\t\t\t\t\t\theaders: { 'Authorization': `Bearer ${this.token}`, 'Content-Type': 'application/json' },\n\t\t\t\t\t\t\tbody: JSON.stringify({ name: user.name, email: user.email, is_active: user.is_active }),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst data = await resp.json();\n\t\t\t\t\t\tif (!resp.ok) {\n\t\t\t\t\t\t\tthis.error = data.error || 'Failed to update user';\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.message = 'User updated';\n\t\t\t\t\t},\n\t\t\t\t\tasync deleteUser(userId) {\n\t\t\t\t\t\tif (!confirm('Delete this user?')) return;\n\t\t\t\t\t\tconst resp = await fetch(`/api/v1/admin/users/${userId}`, { method: 'DELETE', headers: { 'Authorization': `Bearer ${this.token}` } });\n\t\t\t\t\t\tconst data = await resp.json();\n\t\t\t\t\t\tif (!resp.ok) {\n\t\t\t\t\t\t\tthis.error = data.error || 'Failed to delete user';\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.message = 'User deleted';\n\t\t\t\t\t\tthis.users = this.users.filter((u) => u.id !== userId);\n\t\t\t\t\t},\n\t\t\t\t\tasync addRole(user) {\n\t\t\t\t\t\tif (!user.selectedRoleId) return;\n\t\t\t\t\t\tconst resp = await fetch(`/api/v1/admin/users/${user.id}/roles/${user.selectedRoleId}`, { method: 'POST', headers: { 'Authorization': `Bearer ${this.token}` } });\n\t\t\t\t\t\tconst data = await resp.json();\n\t\t\t\t\t\tif (!resp.ok) {\n\t\t\t\t\t\t\tthis.error = data.error || 'Failed to add role';\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.message = 'Role added';\n\t\t\t\t\t\tawait this.load();\n\t\t\t\t\t},\n\t\t\t\t\tasync removeRole(user) {\n\t\t\t\t\t\tif (!user.selectedRoleId) return;\n\t\t\t\t\t\tconst resp = await fetch(`/api/v1/admin/users/${user.id}/roles/${user.selectedRoleId}`, { method: 'DELETE', headers: { 'Authorization': `Bearer ${this.token}` } });\n\t\t\t\t\t\tconst data = await resp.json();\n\t\t\t\t\t\tif (!resp.ok) {\n\t\t\t\t\t\t\tthis.error = data.error || 'Failed to remove role';\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.message = 'Role removed';\n\t\t\t\t\t\tawait this.load();\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = layouts.DashboardLayout(props.AppName, "User Management", "Manage users, roles, and account status", "users").Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
